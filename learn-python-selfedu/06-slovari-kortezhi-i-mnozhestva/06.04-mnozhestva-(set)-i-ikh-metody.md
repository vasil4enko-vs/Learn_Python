# 6.4. Множества (set) и их методы

## 6.4.1. Определение множества

На этом занятии мы познакомимся с последней базовой коллекцией данных - множеством.

**Множество (set)** - это неупорядоченная, изменяемая коллекция уникальных элементов.

Рассмотрим как можно задавать множества и работать с ними. Для этого перейдём в консоль Python:

```bash
$ python
>>>
```

## 6.4.2. Способы создания множества

### 6.4.2.1. Создание множества с помощью фигурных скобок

Самый простой способ задать множество:

```python
a = {1, 2, 3, "hello"}
>>> a
{1, 2, 3, 'hello'}
>>>
```

На выходе получится множество.

Это немного похоже на определение словаря, ведь словарь тоже задаётся с помощью фигурных скобок, но в отличии от словаря здесь не указываются ключи, а сразу прописываются определенные значения.

Чтобы убедиться, что `a` является множеством, мы можем использовать функцию `type()`:

```python
>>> type(a)
<class 'set'>
>>>
```

Т.е. переменная `a`, действительно ссылается на объект, который является множеством.

### 6.4.2.2. В множестве могут быть только уникальные значения

Ключевой особенностью множества является то, что в нём отсутствуют дублирующиеся значения:

```python
>>> a = {1, 2, 3, "hello", 2, 3, "hello"}
>>> a
{1, 2, 3, 'hello'}
>>>
```

Как видите, никаких ошибок нет и дублирующиеся значения не записываются. Это ключевая особенность данной коллекции. **Множество автоматически отбрасывает все дубли**.

Причём, элементами множества могут быть только неизменяемые типы данных.

### 6.4.2.3. Множества могут содержать только неизменяемые типы данных

Во множество мы можем записывать только **неизменяемые данные**, такие как:

- числа;
- булевы значения;
- строки;
- кортежи

А вот изменяемые типы данных:

- списки;
- словари;
- множества

добавлять нельзя, будет ошибка.

Рассмотрим на примерах.

```python
a = {1, 4.5, "hi", (4, True)}
>>> a
{1, 'hi', 4.5, (4, True)}
>>>
```

В кортеже тоже должны быть также неизменяемые данные.

А такие варианты не допустимы:

```python
>>> b = {[1, 2], 3, 4} # список в множестве
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'list'
>>>
```

```python
>>> b = {{1: 1, 2: 2}, 3, 4} # словарь в множестве
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'dict'
>>>
```

```python
>>> b = {{1, 2}, 3, 4} # множество внутри множества
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'set'
>>>
```

Вы видите что в качестве значений множества можно использовать только неизменяемые типы данных.

### 6.4.2.4. Создание пустого множества. Функции set()

Далее, допустим, что нам необходимо создать пустое множество. Для этого, в самом простом варианте, можно использовать функцию `set()`:

```python
>>> set()
set()
>>>
```

На выходе получаем пустое множество.

А если попытаться пустое множество определить при помощи фигурных скобок:

```python
>>> b = {}
>>> b
{}
>>> type(b)
<class 'dict'>
>>>
```

то ничего не выйдет, т.к. такая переменная будет восприниматься как словарь, а не как множество.

Так что если нам нужно создать пустое множество, то надо использовать функцию `set()`.

Также с помощью функции `set()` можно создать множество с определёнными значениями, если в качестве первого аргумента передать итерируемый объект, например список:

```python
>>> set([1, 2, 1, 0, -1, 2])
{0, 1, 2, -1}
>>>
```

На выходе мы получим множество с уникальными значениями.

Или можем в качестве итерируемого объекта использовать строку:

```python
>>> set("abrakadabra")
{'k', 'a', 'b', 'd', 'r'}
>>>
```

На выходе мы получим множество состоящее из уникальных символов этой строки.

Вообще в множестве мы можем указать любой итерируемый объект, например функцию range():

```python
>>> set(range(7))
{0, 1, 2, 3, 4, 5, 6}
>>>
```

Обратите внимание на то, что множество это неупорядоченная коллекция. Т.е. порядок следования значений здесь отсутствует.

И так как множество неупорядоченная коллекция, то обратиться к элементам множества по индексу невозможно:

```python
>>> b[0]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 0
>>>
```

будет ошибка.

И здесь возникает вопрос, для чего вообще в программировании может понадобиться такая коллекция?

С помощью множества можно легко и быстро **убирать дубли из данных**.

Давайте представим себе, что есть некая логистическая компания, которая доставляет товары в разные города и список городов представлен в виде списка `cities`:

```python
>>> cities = ["Калуга", "Краснодар", "Тюмень", "Ульяновск", "Москва", "Тюмень", "Калуга", "Ульяновск"]
```

И отдел статистики хотел бы получить список уникальных городов, с которыми было сотрудничество. Очевидно, это можно сделать с помощью множества:

```python
>>> set(cities)
{'Москва', 'Ульяновск', 'Калуга', 'Тюмень', 'Краснодар'}
>>>
```

и на выходе получим элементы множества только уникальных городов. Мало того мы полученный результат снова можем представить в список, если это необходимо:

```python
>>> list(set(cities))
['Москва', 'Ульяновск', 'Калуга', 'Тюмень', 'Краснодар']
>>>
```

Вот так легко и просто можно сделать это при помощи множества.

## 6.4.3. Перебор элементов множества

А что если элементы множества мы хотим перебрать, например с помощью цикла. Как это можно сделать? Для этого мы просто пишем цикл `for` и перебираем элементы множества, тк. множество это итерируемый объект:

```python
>>> q = set(cities)
>>> q
{'Москва', 'Ульяновск', 'Калуга', 'Тюмень', 'Краснодар'}
>>> for c in q:
...     print(c)
...
Москва
Ульяновск
Калуга
Тюмень
Краснодар
>>>
```

Т.е. множество это итерируемый объект и его так же можно перебирать. И в общем случае использовать механизм итераторов, например:

```python
>>> it = iter(q)
>>> next(it)
'Москва'
>>> next(it)
'Ульяновск'
>>> next(it)
'Калуга'
>>> next(it)
'Тюмень'
>>> next(it)
'Краснодар'
>>> next(it)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
StopIteration
>>>
```

Так можно перебирать элементы множества.

## 6.4.4. Определение общего количества элементов множества. Функция `len()`

Если нам нужно определить общее количество элементов в множестве, то можно использовать функцию `len()`:

```python
>>> len(q)
5
>>>
```

Т.е. множество `q` содержит 5 элементов.

## 6.4.5. Проверка на присутствие элемента в множестве

Если же нам нужно проверить наличие элемента в множестве, то для этого используеться оператор `in`. Для примера проверим присутствует ли элемент `"Москва"` в множестве `q`:

```python
>>> "Москва" in q
True
>>>
```

Получаем значение `True`, т.к. элемент `Москва` действительно присутствует в множестве `q`.

А если записать какую-либо не существующую строку:

```python
>>> "abc" in q
False
>>>
```

## 6.4.6. Методы множества для добавления и удаления элементов

А сейчас рассмотрим методы множества для добавления и удаления элементов.

### 6.4.6.1. Метод `add()`

**Метод `add()`** - добавляет элемент в набор. Если элемент уже существует, метод `add()` не добавляет элемент.

Синтаксис:

```python
set.add(elmnt)
```

Обязательный параметр:

`elmnt` - Элемент, добавляемый в набор

Предположим, что у нас есть пустое множество:

```python
>>> b = set()
>>> b
set()
>>>
```

И мы хотели бы в это множество добавить новые элементы, например число `7`:

```python
>>> b.add(7)
>>> b
{7}
>>>
```

Теперь в множестве присутствует элемент `7`.

Если мы повторим эту операцию, попробуем ещё раз добавить элемент `7`:

```python
>>> b.add(7)
>>> b
{7}
>>>
```

то она не добавится, потому что она уже присутствует.

А если прописать какой-либо другое значение:

```python
>>> b.add(3)
>>> b
{7, 3}
>>>
```

то оно добавится и в множестве уже будет два значения.

### 6.4.6.2. Метод `update()`

**Метод `update()`** - обновляет текущий набор, добавляя элементы из другого набора (или любого другого итерируемого объекта). Если элемент присутствует в обоих наборах, в обновленном наборе будет присутствовать только один вид этого элемента. Вместо этого вы можете использовать оператор `|=`.

Синтаксис:

```python
set.update(set1, set2 ...)
```

Более короткий синтаксис:

```python
set |= set1 | set2 ...
```

Обязательный параметр:

`set1` - Набор, который нужно вставить в текущее множество.

Необязательные параметры:

`set2, ...` - Дополнительные наборы для вставки в текущее множество.
Вы можете вставить столько наборов, сколько захотите.
Разделите наборы с помощью | (трубопроводник).
См. примеры ниже.

Если же необходимо добавить сразу несколько элементов, то можно использовать метод `update()`:

```python
>>> b.update(["a", "b", (1, 2)])
>>> b
{(1, 2), 3, 7, 'a', 'b'}
>>>
```

соответственно, все значения указанные в виде параметров метода `update()` будут добавлены в множество `b`.

Или при помощи этого метода мы можем передать какую-либо строку:

```python
>>> b.update("abrakadabra")
>>> b
{'k', (1, 2), 3, 7, 'a', 'b', 'd', 'r'}
>>>
```

и в множество `b` будут добавлены все уникальные символы этой строки.

Т.е. в качестве параметра метода `update()` можно использовать любой итерируемый объект.

Если нам нужно удалить какое-либо значение из множества, то для этого существует несколько методов.

первым рассмотрим метод `discard()`.

### 6.4.6.3. Метод `discard()`

**Метод `discard()`** - удаляет указанный элемент из множества. Этот метод отличается от метода `remove()`, поскольку метод `remove()` выдаст ошибку, если указанный элемент не существует, а метод `discard()` — нет.

Синтаксис:

```python
set.discard(value)
```

Обязательный параметр:

`value` - Значение, которое нужно удалить из множества.

Например нам нужно из множества `b` удалить значение `2` (обратите внимание, что оно здесь отсутствует):

```python
>>> b.discard(2)
>>> b
{'k', (1, 2), 3, 7, 'a', 'b', 'd', 'r'}
>>>
```

Мы не видим никакой ошибки, т.е. метод сработал, но множество `b` никак не изменилось.

Если же указать существующее значение, например `7`:

```python
>>> b.discard(7)
>>> b
{'k', (1, 2), 3, 'a', 'b', 'd', 'r'}
>>>
```

то, соответственно, элемент `7` будет удален.

### 6.4.6.4. Метод `remove()`

**Метод `remove()`** - удаляет указанный элемент из набора. Этот метод отличается от метода `discard()`, поскольку метод `remove()` выдаст ошибку, если указанный элемент не существует, а метод `discard()` — нет.

Синтаксис:

```python
set.remove(item)
```

Обязательный параметр:

`item` - Значение, которое нужно удалить из множества.

Другой похожий метод — `remove()` делает, в принципе, всё то же самое, что и `discard()`, но при попытке удаления несуществующего значения возвращает ошибку:

```python
>>> b.remove(3)
>>> b
{'k', (1, 2), 'a', 'b', 'd', 'r'}
>>> b.remove(3)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 3
>>>
```

Т.е. они отличаются только этим.

### 6.4.6.5. Метод `pop()`

**Метод `pop()`** - удаляет случайный элемент из набора. Этот метод возвращает удаленный элемент.

Синтаксис:

```python
set.pop()
```

Не имеет параметров.

Метод `pop()` пишется без параметров, удаляет случайный элемент из множества и возвращает его. Случайный, потому что множество это неупорядоченная коллекция.

Например:

```python
>>> b.pop()
>>> b.pop()
'k'
>>> b
{(1, 2), 'a', 'b', 'd', 'r'}
>>>
```

В данном случае метод `pop()` возвратил строку `k` и , соответственно, удалил этот элемент из множества `b`.

Если `pop()` вызвать ещё раз, то будет удалён какой-то другой элемент:

```python
>>> b.pop()
(1, 2)
>>> b
{'a', 'b', 'd', 'r'}
>>>
```

Если у нас есть пустое множество `a` и мы вызовем для него метод `pop()`:

```python
>>> a = set()
>>> a
set()
>>> a.pop()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'pop from an empty set'
>>>
```

то мы получим ошибку.

### 6.4.6.6. Метод `clear()`

**Метод `clear()`** - удаляет все элементы множества.

Синтаксис:

```python
set.clear()
```

Не имеет параметров.

Метод `clear()` пишется без параметров, удаляет все элементы множества.

Например:

```python
>>> b.clear()
>>> b
set()
>>>
```

Соответственно, множество `b` стало пустым.

На этом завершим наше первое знакомство м множествами.

Из этого занятия вам запомнить:

**Множества - изменяемый тип данных.**

Существуют следующие функции и операторы для работы с множествами:

- `set()`;
- `len()`;
- `in`

И следующие методы:

- Метод `add()`;
- Метод `update()`;
- Метод `discard()`;
- Метод `remove()`;
- Метод `pop()`;
- Метод `clear()`.
- Метод `pop()`;
- Метод `clear()`.

**Полезные ссылки:**

Урок в прозе: [https://proproprogs.ru/python_base/python3-mnozhestva-set-i-ih-metody](https://proproprogs.ru/python_base/python3-mnozhestva-set-i-ih-metody "Множества (set) и их методы")

Телеграм-канал: [https://t.me/python_selfedu](https://t.me/python_selfedu "Телеграм канал")

Официальный сайт Python: [https://www.python.org](https://www.python.org "Официальный сайт Python")

PEP 8: [https://www.python.org/dev/peps/pep-0008](https://www.python.org/dev/peps/pep-0008 "PEP 8")
