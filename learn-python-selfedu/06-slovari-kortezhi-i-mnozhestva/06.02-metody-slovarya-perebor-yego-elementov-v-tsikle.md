# 6.2. Методы словаря. Перебор его элементов в цикле

Мы продолжаем изучение словарей языка Python. Это занятие начнем с ознакомления основных методов, которые есть у этой коллекции.

## 6.2.1. Метод `fromkeys()`

Начнем с метода `fromkeys()`.

**Метод `fromkeys()`** - возвращает словарь с указанными в списке ключами и некоторым значением.

Синтаксис:

```python
dict.fromkeys(keys, value)
```

Обязательный параметр:

`keys` - Итерация, определяющая ключи нового словаря.

Необязательный параметр:

`value` - Значение, которое будет присвоено всем ключам. По умолчанию равно `None`.

Рассматрим как это работает. Для чего перейдем в консоль Python.

Например у нас есть список `lst`, который содержит следующие значения:

```python
>>> lst = ["+7", "+6", "+5", "+4"]
>>>
```

и мы хотели бы, что бы эти строки были ключами нашего нового словаря.

Тут нам и пригодится метод `fromkeys()` для создания словаря:

```python
>>> a = dict.fromkeys(lst)
>>>
```

Теперь посмотрим, что у нас получилось:

```python
>>> a
{'+7': None, '+6': None, '+5': None, '+4': None}
>>>
```

Обратите внимание, все значения у ключей равны None. Это значение по умолчанию. Чтобы его изменить используется второй необязательный аргумент, например:

```python
>>> a = dict.fromkeys(["+7", "+6", "+5", "+4"], "код страны")
>>> a
{'+7': 'код страны', '+6': 'код страны', '+5': 'код страны', '+4': 'код страны'}
>>>
```

на выходе получаем словарь с этим новым указанным значением:

```python
{'+7': 'код страны', '+6': 'код страны', '+5': 'код страны', '+4': 'код страны'}
```

## 6.2.2. Метод `clear()`

Следующий метод - `clear()`.

**Метод `d.clear()`** - Метод `сlear()` удаляет все элементы из словаря.

Синтаксис:

```python
dictionary.clear()
```

Не имеет параметров.

Сейчас наш словарь содержит следующую информацию:

```python
>>> a
{'+7': 'код страны', '+6': 'код страны', '+5': 'код страны', '+4': 'код страны'}
>>>
```

Применим метод `clear()` к нему и посмотрим на результат:

```python
>>> a.clear()
>>> a
{}
>>>
```

Мы получили пустой словарь. Т.е. если нужно быстро очистить словарь, то как раз вызывается метод `clear()`.

## 6.2.3. Метод `copy()`

Далее, для создания копии словаря используется метод `copy()`:

**Метод `copy()`** - возвращает копию указанного словаря.

Синтаксис:

```python
dictionary.copy()
```

Не имеет параметров.

Далее предположим, что у нас есть такой словарь:

```python
>>> d = {True: 1, False: "Ложь", "list": [1, 2, 3], 5: 5}
>>> d
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5}
>>>
```

Если мы поступим следующим образом:

```python
>>> d2 = d
>>>
```

То, вы понимаете, что копия словаря сдесь создаваться не будет. В этом случае переменные `d` и `d2` будут ссылаются на один и тот же словарь. При изменении одного словаря изменится и второй.

Но как же нам создать именно копию, продублировать этот же словарь в памяти компьютера?

Для этого и существует метод `copy()`.

```python
>>> d2 = d.copy()
>>> d2
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5}
>>> d2["list"] = [5, 6, 7]
>>> d
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5}
>>> d2
{True: 1, False: 'Ложь', 'list': [5, 6, 7], 5: 5}
>>>
```

Как видите словарь `d` остался прежним, а словарь `d2` изменился. Это и говорит о том, что словари `d` и `d2` - два разных словаря. Но словарь `d2` был создан как копия словаря `d`. Т.е. мы создали копию `d2` и изменяя её никак не повлияем на изначальный словарь `d`.

Также копию можно создавать и с помощью функции `dict()`, о которой мы с вами говорили на предыдущем занятии:

```python
>>> d2 = dict(d)
>>> d2
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5}
>>>
```

Как видите мы снова получили копию словаря `d`. Проверить же что словари `d` и `d2` - два разных словаря можно при помощи функции `id()`:

```python
>>> id(d)
125495952831232
>>> id(d2)
125495951323008
>>>
```

Как видите, идентификаторы словарей `d` и `d2` не совпадают, что говорит о том, что переменные `d` и `d2` ссылаются на разные словари.

Т.о результат применения функции `dict()` будет абсолютно таким же, что и при вызове метода `copy()`.

## 6.2.4. Метод `get()`

Следующий метод `get()` позволяет получать значение словаря по ключу.

**Метод `get()`** - возвращает значение словаря по указанному ключу.

Синтаксис:

```python
dictionary.get(keyname, value)
```

Обязательный параметр:

`keyname` - Имя ключа элемента, из которого вы хотите вернуть значение.

Необязательный параметр:

`value` - Значение, возвращаемое, если указанный ключ не существует.
Значение по умолчанию - `None`.

В качестве первого аргумента мы должны указать имя ключа, значение которого мы хотим получить:

```python
>>> d.get("list")
[1, 2, 3]
>>>
```

На выходе мы как раз видим значение элемента с указанным ключом.

В чём же отличие от следующей записи?

```python
>>> d["list"]
[1, 2, 3]
>>>
```

Результат получается тот же. Но если мы укажем не существующий в словаре ключ, то получим ошибку:

```python
>>> d[3]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 3
>>>
```

А вот с методом `get()` у нас этого не происходит:

```python
>>> print(d.get(3))
None
>>>
```

Это значение можно изменить, указав его вторым аргументом:

```python
>>> d.get(3, False)
False
>>>
```

Иногда это тоже бывает полезным при разработке различных программ, когда если ключ существует, то мы получаем его значение, а если нет, то получим указанное значение, например `False`.

## 6.2.5. Метод `setdefault()`

Метод похожий на метод `get()` - `setdefault()`.

**Метод `setdefault()`** - возвращает значение элемента с указанным ключом. Если ключ не существует, добавляет ключ с указанным значением.

Синтаксис:

```python
dictionary.setdefault(keyname, value)
```

Обязательный параметр:

`keyname` - Имя ключа элемента, из которого вы хотите вернуть значение.

Необязательный параметр:

`value` - Значение, возвращаемое, если указанный ключ не существует. Если ключ существует, этот параметр не имеет никакого эффекта. Если ключ не существует, это значение становится значением ключа. Значение по умолчанию - `None`.

Разберёмся как работает этот метод.

Если мы вызовем метод `setdefault()` с существующим ключом, например опять `list`:

```python
>>> d.setdefault("list")
[1, 2, 3]
>>>
```

То получим просто значение этого ключа и словарь `d` никак не изменился:

```python
>>> d
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5}
>>>
```

А если указать не существующий ключ, например `3`:

```python
>>> print(d.setdefault(3))
None
>>> d
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5, 3: None}
>>>
```

Во-первых возвратилось значение `None`. И в нашем словаре появилась запись с ключом `3` и значением `None`. Удалим его:

```python
>>> del d[3]
>>> d
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5}
```

А теперь добавим этот же ключ `3` со значением `three`:

```python
>>> d.setdefault(3, "three")
'three'
>>> d
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5, 3: 'three'}
>>>
```

После применения метода `setdefault()` мы видим, что он возвратил значение `"three"`, которое мы записали вторым аргументом. И кроме того в словаре появился новый элемент с ключом `3` и значением `three`.

Так работает метод `setdefault()`, если ключ существует, то он возвращает его значение. Если нет, то добавляется соответствующая запись в словарь.

## 6.2.6. Метод `pop()`

Следующий метод `pop()`.

**Метод `pop()`** - удаляет элемент словаря по указанному ключу. Значение удаленного элемента — это возвращаемое значение метода pop().

Синтаксис:

```python
dictionary.pop(keyname, defaultvalue)
```

Обязательный параметр:

`keyname` - Имя ключа элемента, который вы хотите удалить. Если ключ не существует, возникает ошибка.

Необязательный параметр:

`defaultvalue` - Значение, возвращаемое, если указанный ключ не существует. Если этот параметр не указан и элемент с указанным ключом не найден, возникает ошибка.

Удалим с помощью метода `pop()` элемент с ключом `3`:

```python
>>> d.pop(3)
'three'
>>> d
{True: 1, False: 'Ложь', 'list': [1, 2, 3], 5: 5}
```

Как видите этот метод удаляет указанный ключ и возвращает его значение.

Если мы попытаемся удалить несуществующий ключ, то возникает ошибка:

```python
>>> d.pop("abc")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'abc'
>>>
```

Но мы можем легко исправить ситуацию, если в качестве второго аргумента указать значение, возвращаемое при отсутствии ключа:

```python
>>> d.pop("abc", False)
False
>>>
```

Теперь нет никакой ошибки. Здесь возвратится `False`. Если же ключ присутствует, то возвращается его значение.

## 6.2.7. Метод `popitem()`

Следующий метод `popitem()`.

**Метод `popitem()`** - удаляет элемент, который был последним вставлен в словарь. В версиях до 3.7 метод popitem() удаляет случайный элемент. Удаленный элемент — это возвращаемое значение метода popitem() в виде кортежа. Если словарь пустой то возникает ошибка.

Синтаксис:

```python
dictionary.popitem()
```

Не имеет параметров.

Если мы применим метод `popitem()` к нашему словарю `d`:

```python
>>> d.popitem()
(5, 5)
>>> d
{True: 1, False: 'Ложь', 'list': [1, 2, 3]}
```

Как вы видите, данный метод удалил последний элемент словаря и вернул его в виде кортежа.

Попробуум еще раз:

```python
>>> d.popitem()
('list', [1, 2, 3])
>>> d
{True: 1, False: 'Ложь'}
>>>
```

И сноваа был удалён последний элемент словаря.

Если же мы применим метод к пустому словарю, то возникнет ошибка:

```python
>>> d2 = {}
>>> d2
{}
>>> d2.popitem()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'popitem(): dictionary is empty'
>>>
```

## 6.2.8. Методы `keys()` и `values()`

Следующий метод `keys()`.

**Метод `keys()`** - возвращает объект представления. Объект представления содержит ключи словаря в виде списка. Объект представления будет отражать любые изменения, внесенные в словарь.

Синтаксис:

```python
dictionary.keys()
```

Не имеет параметров.

Пример:

```python
>>> d.keys()
dict_keys([True, False])
>>> d
{True: 1, False: 'Ложь'}
>>>
```

Метод `keys()` возвратил список ключей словаря `True` и `False`.

Вернём наш словарь `d` в изначальное состояние и применим к нему метод `keys()`:

```python
>>> d = {True: 1, False: "Ложь", "list": [1,2,3], 5: 5}
>>> d.keys()
dict_keys([True, False, 'list', 5])
>>>
```

По умолчанию цикл `for` обходит словарь именно по этой коллекции `[True, False, 'list', 5]`, т.е. по ключам:

```python
>>> for x in d:
...     print(x)
...
True
False
list
5
>>>
```

В результате мы получили коллекцию из ключей словаря.

Вы можете убедиться, что эта запись эквивалента такой:

```python
for x in d.keys():
...     print(x)
...
True
False
list
5
>>>
```

Результаты совпадают.

Если же вместо `keys` записать метод `values`:

```python
for x in d.values():
    ...
```

Но у словаря могут быть и другие коллекции. Например, `values()`.

**Метод `values()`** - возвращает объект представления. Объект представления содержит значения словаря в виде списка. Объект представления будет отражать любые изменения, внесенные в словарь.

Синтаксис:

```python
dictionary.values()
```

Не имеет параметров.

Используя метод `values()`, мы будем получать список значений словаря:

```python
>>> d.values()
dict_values([1, 'Ложь', [1, 2, 3], 5])
>>>
```

Если бы мы, при помощи цикла `for`, хотели обойти словарь по значениям, то это можно было бы сделать так:

```python
>>> for x in d.values():
...     print(x)
...
1
Ложь
[1, 2, 3]
5
>>>
```

В результате мы получили коллекцию из значений словаря.

## 6.2.9. Метод `items()`

Если же нам сразу нужны и ключи и значения, то существует ещё один метод `items()`.

**Метод `items()`** - возвращает объект представления. Объект представления содержит пары ключ-значение словаря в виде кортежей в списке. Объект представления будет отражать любые изменения, внесенные в словарь.

Синтаксис:

```python
dictionary.items()
```

Не имеет параметров.

Так, например, такой код:

```python
for x in d.items():
...     print(x)
...
(True, 1)
(False, 'Ложь')
('list', [1, 2, 3])
(5, 5)
>>>
```

В результате мы получим список из кортежей в формате пар ключ-значение.

Давайте мы вызовем этот метод отдельно:

```python
>>> d.items()
dict_items([(True, 1), (False, 'Ложь'), ('list', [1, 2, 3]), (5, 5)])
>>>
```

Здесь нагляднее видно, что у нас получился список из кортежей.

О кортежах мы будем говорить позже, здесь лишь отмечу, что к элементу кортежа можно обратиться по индексу и вывести отдельно ключи и значения:

```python
>>> x = (1, 2)
>>> print(x[0], x[1])
1 2
>>>
```

Или, используя синтаксис множественного присваивания:

```python
x, y = (1, 2)
>>> print(x, y)
1 2
>>> x
1
>>> y
2
>>>
```

Используя такой синтаксис `x, y = (1, 2)` мы можем в цикле `for` сразу перебрать ключи и значения словаря:

```python
>>> for key, value in d.items():
...     print(key, value)
...
True 1
False Ложь
list [1, 2, 3]
5 5
>>>
```

что гораздо удобнее и нагляднее.

## 6.2.10. Метод `update()`

Следующий метод `update()` позволяет обновлять словарь содержимым другого словаря.

**Метод `update()`** - вставляет указанные элементы в словарь. Указанные элементы могут быть словарем или итерируемым объектом с парами ключ-значение. Если ключи совпадают, то значения перезаписываются.

Синтаксис:

```python
dictionary.update(iterable)
```

Обязательный параметр:

`iterable` - Словарь или итерируемый объект с парами ключ-значение, который будет вставлен в словарь.

Предположим, что у нас в программе есть два словаря

```python
>>> d = dict(one = 1, two = 2, three = "3", four = "4")
>>> d
{'one': 1, 'two': 2, 'three': '3', 'four': '4'}
>>> d2 = {2: "неудовлетворительно", 3: "удовлетворительно", 'four': "хорошо", 5: "отлично"}
>>> d2
{2: 'неудовлетворительно', 3: 'удовлетворительно', 'four': 'хорошо', 5: 'отлично'}
>>>
```

И мы хотим обновить первый словарь `d` содержимым второго - `d2`. Для этого есть специальный метод `update()`, который применяется следующим образом:

```python
>>> d.update(d2)
```

Как будет происходить обновление?

Давайте посмотрим на результат работы этого метода:

```python
>>> d
{'one': 1, 'two': 2, 'three': '3', 'four': 'хорошо', 2: 'неудовлетворительно', 3: 'удовлетворительно', 5: 'отлично'}
>>>
```

**Обратите внимание**, ключ `four` был заменен строкой `"хорошо"`, а остальные, не существующие в словаре `d` ключи были добавлены.

Именно так работает меьсметод `update()`.

Если же нам нужно создать новый словарь, который бы объединял содержимое обоих, то для этого можно воспользоваться конструкцией:

```python
d = dict(one = 1, two = 2, three = "3", four = "4")
d2 = {2: "неудовлетворительно", 3: "удовлетворительно", 'four': "хорошо", 5: "отлично"}
>>> d
{'one': 1, 'two': 2, 'three': '3', 'four': '4'}
>>> d2
{2: 'неудовлетворительно', 3: 'удовлетворительно', 'four': 'хорошо', 5: 'отлично'}
>>> d3 = {**d,**d2}
>>> d3
{'one': 1, 'two': 2, 'three': '3', 'four': 'хорошо', 2: 'неудовлетворительно', 3: 'удовлетворительно', 5: 'отлично'}
>>>
```

Причём, ключ `four` был заменен строкой `"хорошо"`, потому что словарь `d2` добавлялся после словаря `d`.

Если же порядок их поменять:

```python
>>> d3 = {**d2,**d}
>>> d3
{2: 'неудовлетворительно', 3: 'удовлетворительно', 'four': '4', 5: 'отлично', 'one': 1, 'two': 2, 'three': '3'}
>>>
```

Здесь наоборот сначал брался словарь `d2`, а потом добавлялся словарь `d` и значение элемента с ключом `four` заменялось на строку `"4"`.

Таким образом можно делать объединение двух и более словарей используя такой достаточно простой синтаксис.

Однако, детально как работает оператор `**` будет понятно позже, когда мы познакомимся с операторами распаковки коллекций. Пока просто запомните, что для объединения словарей можно использовать оператор `**`.

Итак, на этом занятии мы с вами познакомились с основными методами словарей, а также способами их перебора и объединения. Для закрепления этого материала выполните практические задания и переходите к следующему уроку.

Начиная с версии Python 3.9 вместо мтода `update()` можно использовать оператор `|=`:

```python
>>> d = dict(one = 1, two = 2, three = "3", four = "4")
>>> d2 = {2: "неудовлетворительно", 3: "удовлетворительно", 'four': "хорошо", 5: "отлично"}
>>> d |= d2
>>> d
{'one': 1, 'two': 2, 'three': '3', 'four': 'хорошо', 2: 'неудовлетворительно', 3: 'удовлетворительно', 5: 'отлично'}
>>>
```

Или можно использовать оператор `|`:

```python
>>> d = dict(one = 1, two = 2, three = "3", four = "4")
>>> d2 = {2: "неудовлетворительно", 3: "удовлетворительно", 'four': "хорошо", 5: "отлично"}
>>> d3 = {}
>>> d3 = d | d2
>>> d3
{'one': 1, 'two': 2, 'three': '3', 'four': 'хорошо', 2: 'неудовлетворительно', 3: 'удовлетворительно', 5: 'отлично'}
>>>
```

Это действие возвращает новый объединенный словарь, сохраняя неизменными изначальные словари. И здесь также можно объединять два и более словарей.

Фактически запись `d3 = d | d2` эквивалентна записи `d3 = {**d, **d2}`.

Итак, на этом занятии мы познакомились с основными методами словарей, а также со способами их перебора и объединения.

**Полезные ссылки:**

Урок в прозе: [https://proproprogs.ru/python_base/python3-metody-slovarya-perebor-elementov-slovarya-v-cikle](https://proproprogs.ru/python_base/python3-metody-slovarya-perebor-elementov-slovarya-v-cikle "Урок в прозе")

Телеграм-канал: [https://t.me/python_selfedu](https://t.me/python_selfedu "Телеграм-канал")

Официальный сайт Python: [https://www.python.org](https://www.python.org "Официальный сайт Python")

PEP 8: [https://www.python.org/dev/peps/pep-0008/](https://www.python.org/dev/peps/pep-0008/ "PEP 8")
