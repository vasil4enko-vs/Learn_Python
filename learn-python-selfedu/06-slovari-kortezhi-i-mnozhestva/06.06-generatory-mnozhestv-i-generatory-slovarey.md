# 6.6. Генераторы множеств и генераторы словарей

На этом занятии мы с вами поговорим о генераторах множеств и словарей.

## 6.6.1. Вспомним генераторы списков

Ранее мы уже рассматривали генераторы списков, когда мы их создавали, используя  синтаксис:

```python
[<способ формирования значения> for <счетчик> in <итерируемый объект>]
```

Например (файл `06.06.01.py`):

```python
a = [x ** 2 for x in range(1, 5)]

print(a)
```

Запустим программу:

```python
[1, 4, 9, 16]
```

и увидим квадраты чисел от 1 до 4.

Это мы с вами уже проходили, а сейчас просто вспомнили как работают генераторы списков.

По аналогии можно делать также генераторы и для множеств и для словарей.

## 6.6.2. Генераторы множеств и словарей

Для этого достаточно заменить квадратные скобки на фигурные (файл `06.06.02.py`):

```python
a = {x**2 for x in range(1, 5)}

print(a)
```

запустим программу:

```python
{1, 4, 9, 16}
```

теперь мы получили не список, а множество.

А если дополнительно добавить ключ, например (файл `06.06.03.py`):

```python
a = {x: x**2 for x in range(1, 5)}

print(a)
```

то мы получим словарь:

```python
{1: 1, 2: 4, 3: 9, 4: 16}
```

Т.о., в целом, работают генераторы множеств и генераторы словарей.

И здесь возникает вопрос, а где такие генераторы могут использоваться?

Давайте представим, что нам нужно создать множество состоящее исключительно из чисел, т.е. строки нужно преобразовать в числа. Это очень просто можно сделать с помощью генератора множеств (файл `06.06.04.py`).

```python
d = [1, 2, '1', '2', -4, 3, 4]

a = {int(x) for x in d}

print(a)
```

запустив программу:

```python
{1, 2, 3, 4, -4}
```

мы действительно получим множество из уникальных значений, которые все являются числами.

Причём полученная нами программа будет гораздо быстрее работать, чем если бы мы это сделали через цикл, например (файл `06.06.05.py`):

```python
d = [1, 2, "1", "2", -4, 3, 4]

set_d = set()
for x in d:
    set_d.add(int(x))

print(set_d)
```

эта программа даст тот же самый результат:

```python
{1, 2, 3, 4, -4}
```

но программа с циклом будет работать дольше, чем генератор множеств. И визуально программа с генератором множеств будет более комплексной, наглядной и понятной.

Т.е. везде где мы модем заменить цикл генератором множеств, генератором словарей или генератором списков то именно так и следует поступать.

Рассмотрим пример со словарём. Предположим, что у нас есть словарь `m`, где мы хотели бы все ключи записать заглавными буквами, а все значения превратить в числа (файл `06.06.06.py`):

```python
m = {"неудовл.": 2, "удовл.": 3, "хорошо": '4', "отлично": '5'}

a = {key.upper(): int(value) for key, value in m.items()}

print(a)
```

Результатом выполнения программы будет нужный нам словарь:

```python
{'НЕУДОВЛ.': 2, 'УДОВЛ.': 3, 'ХОРОШО': 4, 'ОТЛИЧНО': 5}
```

Видите, как легко и элегантно можно реализовать такую программу.

## 6.6.3. Генераторы множеств и словарей с условием

В генераторах множеств и словарей, как и в генераторах списков, можно использовать условия.

Например, мы хотим изначальный список превратить в множество состоящие только из положительных чисел и строки преобразовать в целые числа (файл `06.06.07.py`):

```python
d = [1, 2, "1", "2", -4, 3, 4]

a = {int(x) for x in d if int(x) > 0}

print(a)
```

результат:

```python
{1, 2, 3, 4}
```

множество состоящее только из положительных чисел.

В качестве примера использования генератора словарей с условием возьмём словарь и его ключи превратим в значения, а значения в ключи, причём выберем оценки только от `2` до `5` (файл `06.06.08.py`):

```python
m = {
    "безнадежно": 0,
    "убого": 1,
    "неудовл.": 2,
    "удовл.": 3,
    "хорошо": "4",
    "отлично": "5",
}

a = {int(value): key for key, value in m.items() if 2 <= int(value) <= 5}  # noqa: PLR2004

print(a)
```

Запустим программу:

```python
{2: 'неудовл.', 3: 'удовл.', 4: 'хорошо', 5: 'отлично'}
```

мы получили словарь, в котором мы поменяли местами ключи и значения и выбрали оценки от `2` до `5` включительно.

Ещё раз напомню, что преимущество генераторов списков, множеств и словарей перед циклами в их более высокой скорости выполнения, ну и наглядность текста программы.

Поэтому там где относительно легко можно заменить циклы на генераторы, так стоит и делать.

## 6.6.4. Вложенные генераторы множеств и словарей

Также в генераторах множеств и словарей можно применять и вложенные схемы, когда один генератор вложен в другой. Причём здесь можно комбинировать генераторы списков, множеств и словарей. Всё это делается по аналогии с вложенными генераторами списков о которых мы с вами уже говорили.

Я думаю из этого занятия вы поняли как применять генераторы множеств и словарей.

**Полезные ссылки**

Урок в прозе: [https://proproprogs.ru/python_base/python3-generatory-mnozhestv-i-generatory-slovarey](https://proproprogs.ru/python_base/python3-generatory-mnozhestv-i-generatory-slovarey "Генераторы множеств и генераторы словарей")

Телеграм-канал: [https://t.me/python_selfedu](https://t.me/python_selfedu "Телеграм канал")

Официальный сайт Python: [https://www.python.org](https://www.python.org "Официальный сайт Python")

PEP 8: [https://www.python.org/dev/peps/pep-0008/](https://www.python.org/dev/peps/pep-0008/ "PEP 8")
